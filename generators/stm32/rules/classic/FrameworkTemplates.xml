<?xml version="1.0"?>
<FamilyDefinition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
	<AdditionalFrameworks>
		<Framework>
			<!-- Warning: some parts of the HAL library depend on functions implemented in the LL library, hence HAL-based projects now must reference both HAL and LL frameworks. -->
			<Name>$$STM32:FAMILY$$ HAL Library</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_hal</ID>
			<ClassID>com.sysprogs.arm.stm32.hal</ClassID>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_ll</string>
			</RequiredFrameworks>
			<IncompatibleFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_stdperiph</string>
			</IncompatibleFrameworks>
			<ProjectFolderName>HAL</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\$$STM32:FAMILY$$xx_HAL_Driver</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<!-- Note: "&gt;" (i.e. ">") before the mask below means "treat the rest of the mask as a regex" -->
					<ProjectInclusionMask>-*_template.?;-&gt;.*stm32[^\\]+_ll_[^\\]+$;*</ProjectInclusionMask>
				</CopyJob>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\CMSIS</SourceFolder>
					<FilesToCopy>-*Examples\*;-DSP\*;-DSP_Lib\*;*.h;*.c</FilesToCopy>
					<TargetFolder>CMSIS_HAL</TargetFolder>
					<PreprocessorMacros>$$com.sysprogs.stm32.hal_device_family$$</PreprocessorMacros>
					<ProjectInclusionMask>-Examples\*;-RTOS2\*;-Core\Template\*;-Core_A\*;-NN\*;-*Include\stm32??????.h*;-*system_*.c;*</ProjectInclusionMask>
					<AutoIncludeMask>-Examples\*;-RTOS\Template\*;-RTOS2\Template\*;-NN\*;-Core_A\*;*.h</AutoIncludeMask>					
				</CopyJob>
			</CopyJobs>			
		</Framework>
		<Framework>
			<Name>$$STM32:FAMILY$$ Low-level Driver Library</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_ll</ID>
			<ClassID>com.sysprogs.arm.stm32.ll</ClassID>
			<IncompatibleFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_stdperiph</string>
			</IncompatibleFrameworks>
			<ProjectFolderName>LL</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\$$STM32:FAMILY$$xx_HAL_Driver</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<!-- Note: "&gt;" (i.e. ">") before the mask below means "treat the rest of the mask as a regex" -->
					<ProjectInclusionMask>&gt;.*stm32[^\\]+_ll_[^\\]+\.(h|c|cpp)</ProjectInclusionMask>
					<PreprocessorMacros>$$com.sysprogs.stm32.hal_device_family$$;$$com.sysprogs.bspoptions.stm32.ll_driver$$</PreprocessorMacros>
					<AlreadyCopied>true</AlreadyCopied>
					<AdditionalIncludeDirs>Inc;$$SYS:BSP_ROOT$$/$$STM32:FAMILY$$xxxx/CMSIS_HAL/Device/ST/$$STM32:FAMILY$$xx/Include;$$SYS:BSP_ROOT$$/$$STM32:FAMILY$$xxxx/CMSIS_HAL/Core/Include</AdditionalIncludeDirs>
				</CopyJob>
			</CopyJobs>			
			<ConfigurableProperties>
				<PropertyGroups>
				  <PropertyGroup>
					<Properties>
					  <PropertyEntry xsi:type="Boolean">
						<Name>Enable Advanced Low-Level Driver Functions</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.ll_driver</UniqueID>
						<ValueForTrue>USE_FULL_LL_DRIVER</ValueForTrue>
						<ValueForFalse></ValueForFalse>
					  </PropertyEntry>
					</Properties>
					<CollapsedByDefault>false</CollapsedByDefault>
				  </PropertyGroup>
				</PropertyGroups>
			</ConfigurableProperties>			
		</Framework>
		<Framework>
			<Name>$$STM32:FAMILY$$ Default System Init File</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_systeminit</ID>
			<ClassID>com.sysprogs.arm.stm32.hal_systeminit</ClassID>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY$$_hal</string>
			</RequiredFrameworks>
			<ProjectFolderName>SystemInit</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<AlreadyCopied>true</AlreadyCopied>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\CMSIS</SourceFolder>
					<TargetFolder>CMSIS_HAL</TargetFolder>
					<FilesToCopy>*system_stm*.c</FilesToCopy>
				</CopyJob>
			</CopyJobs>			
		</Framework>
		<Framework>
			<Name>STM32 USB Device Library</Name>
			<ID>com.sysprogs.arm.stm32.usbdev.$$STM32:FAMILY$$</ID>
			<ClassID>com.sysprogs.arm.stm32.usbdev</ClassID>
			<ProjectFolderName>USB Device</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_USB_Device_Library</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;*</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>Core/Inc;Class/$$com.sysprogs.bspoptions.stm32.usb.devclass$$/Inc</AdditionalIncludeDirs>
					<PreprocessorMacros>USE_USB_$$com.sysprogs.bspoptions.stm32.usb.speed$$</PreprocessorMacros>
					<SimpleFileConditions>
						<string>Class\\AUDIO\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == AUDIO</string>
						<string>Class\\CDC\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == CDC</string>
						<string>Class\\CustomHID\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == CustomHID</string>
						<string>Class\\DFU\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == DFU</string>
						<string>Class\\HID\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == HID</string>
						<string>Class\\MSC\\: $$com.sysprogs.bspoptions.stm32.usb.devclass$$ == MSC</string>
					</SimpleFileConditions>
					<Patches>
						<Patch xsi:type="InsertLines">
							<FilePath>core\src\usbd_core.c</FilePath>
							<AfterLine>#include "usbd_core.h"</AfterLine>
							<InsertedLines>
								<string>#ifndef UNUSED</string>
								<string>#define UNUSED(x) ((void)(x));</string>
								<string>#endif</string>															
							</InsertedLines>
						</Patch>											
					</Patches>
				</CopyJob>
			</CopyJobs>
			<ConfigurableProperties>
				<PropertyGroups>
				  <PropertyGroup>
					<Properties>
					    <PropertyEntry xsi:type="Enumerated">
						<Name>USB Device Class</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.devclass</UniqueID>
						<OmitPrefixIfEmpty>false</OmitPrefixIfEmpty>
						<SuggestionList>
						  <Suggestion>
							<UserFriendlyName>Audio Device</UserFriendlyName>
							<InternalValue>AUDIO</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>Communications Device (CDC)</UserFriendlyName>
							<InternalValue>CDC</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>Custom Human Interface Device (CustomHID)</UserFriendlyName>
							<InternalValue>CustomHID</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>Device Firmware Update (DFU)</UserFriendlyName>
							<InternalValue>DFU</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>Human Interface Device (HID)</UserFriendlyName>
							<InternalValue>HID</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>Mass Storage (MSC)</UserFriendlyName>
							<InternalValue>MSC</InternalValue>
						  </Suggestion>
						  <Suggestion>
							<UserFriendlyName>None</UserFriendlyName>
							<InternalValue>none</InternalValue>
						  </Suggestion>
						</SuggestionList>
						<DefaultEntryIndex>1</DefaultEntryIndex>
						<AllowFreeEntry>false</AllowFreeEntry>
					  </PropertyEntry>
						<PropertyEntry xsi:type="Enumerated">
						  <Name>USB Device Speed</Name>
						  <UniqueID>com.sysprogs.bspoptions.stm32.usb.speed</UniqueID>
						  <Description>Specifies the USB peripheral (USB_FS vs USB_HS) used by the device</Description>
						  <SuggestionList>
							<Suggestion><InternalValue>FS</InternalValue><UserFriendlyName>USB 2.0 Full Speed</UserFriendlyName></Suggestion>
							<Suggestion><InternalValue>HS</InternalValue><UserFriendlyName>USB 2.0 High Speed</UserFriendlyName></Suggestion>
						  </SuggestionList>
						  <DefaultEntryIndex>0</DefaultEntryIndex>
						  <AllowFreeEntry>false</AllowFreeEntry>
						</PropertyEntry>
					</Properties>
					<CollapsedByDefault>false</CollapsedByDefault>
				  </PropertyGroup>
				</PropertyGroups>
			</ConfigurableProperties>			
		</Framework>

		<Framework>
			<Name>STM32 USB Host Library</Name>
			<ID>com.sysprogs.arm.stm32.usbhost.$$STM32:FAMILY$$</ID>
			<ClassID>com.sysprogs.arm.stm32.usbhost</ClassID>
			<ProjectFolderName>USB Host</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_USB_Host_Library</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;*</ProjectInclusionMask>
					<PreprocessorMacros>USE_USB_$$com.sysprogs.bspoptions.stm32.usb.speed$$</PreprocessorMacros>
					<SimpleFileConditions>
						<string>Class\\MTP\\: $$com.sysprogs.bspoptions.stm32.usb.host.mtp$$ == 1</string>
						<string>Class\\MSC\\: $$com.sysprogs.bspoptions.stm32.usb.host.msc$$ == 1</string>
						<string>Class\\HID\\: $$com.sysprogs.bspoptions.stm32.usb.host.hid$$ == 1</string>
						<string>Class\\CDC\\: $$com.sysprogs.bspoptions.stm32.usb.host.cdc$$ == 1</string>
						<string>Class\\Audio\\: $$com.sysprogs.bspoptions.stm32.usb.host.audio$$ == 1</string>
					</SimpleFileConditions>
				</CopyJob>
			</CopyJobs>
			<ConfigurableProperties>
				<PropertyGroups>
				  <PropertyGroup>
					<Properties>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host Audio Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.audio</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host CDC Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.cdc</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host HID Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.hid</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host Mass Storage Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.msc</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host MTP Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.mtp</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
						<PropertyEntry xsi:type="Enumerated">
						  <Name>USB Device Speed</Name>
						  <UniqueID>com.sysprogs.bspoptions.stm32.usb.speed</UniqueID>
						  <Description>Specifies the USB peripheral (USB_FS vs USB_HS) used by the device</Description>
						  <SuggestionList>
							<Suggestion><InternalValue>FS</InternalValue><UserFriendlyName>USB 2.0 Full Speed</UserFriendlyName></Suggestion>
							<Suggestion><InternalValue>HS</InternalValue><UserFriendlyName>USB 2.0 High Speed</UserFriendlyName></Suggestion>
						  </SuggestionList>
						  <DefaultEntryIndex>0</DefaultEntryIndex>
						  <AllowFreeEntry>false</AllowFreeEntry>
						</PropertyEntry>
					</Properties>
					<CollapsedByDefault>false</CollapsedByDefault>
				  </PropertyGroup>
				</PropertyGroups>
			</ConfigurableProperties>			
		</Framework>

	</AdditionalFrameworks>	
</FamilyDefinition>
